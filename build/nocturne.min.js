(function(_1){
function _2(){
return _2.init.apply(_2,arguments);
};
_2.VERSION="0.0.13";
_2.lesson="Part 13: Chaining";
_2.alis="$t";
_2.isArray=Array.isArray||function(_3){
return !!(_3&&_3.concat&&_3.unshift&&!_3.callee);
};
_2.isNumber=function(_4){
return (_4===+_4)||(toString.call(_4)==="[object Number]");
};
_2.bind=function(fn,_5){
var _6=Array.prototype.slice,_7=_6.apply(arguments,[2]);
return function(){
return fn.apply(_5||{},_7.concat(_6.apply(arguments)));
};
};
_2.exportAlias=function(_8,_9){
_1[_8]=_9();
};
_2.init=function(){
};
if(_1.nocturne){
throw new Error("nocturne has already been defined");
}else{
_1.nocturne=_2;
}
})(typeof window==="undefined"?this:window);
nocturne.Class=function(){
return nocturne.oo.create.apply(this,arguments);
};
nocturne.oo={create:function(){
var _a=null,_b=undefined,_c=function(){
this.$super=function(_d,_e){
return nocturne.oo.$super(this.$parent,this,_d,_e);
};
this.initialize.apply(this,arguments);
};
if(typeof arguments[0]==="function"){
_b=arguments[0];
_a=arguments[1];
}else{
_a=arguments[0];
}
if(typeof _b!=="undefined"){
nocturne.oo.extend(_c.prototype,_b.prototype);
_c.prototype.$parent=_b.prototype;
}
nocturne.oo.mixin(_c,_a);
nocturne.oo.extend(_c.prototype,_a);
_c.prototype.constructor=_c;
if(!_c.prototype.initialize){
_c.prototype.initialize=function(){
};
}
return _c;
},mixin:function(_f,_10){
if(typeof _10.include!=="undefined"){
if(typeof _10.include==="function"){
nocturne.oo.extend(_f.prototype,_10.include.prototype);
}else{
for(var i=0;i<_10.include.length;i++){
nocturne.oo.extend(_f.prototype,_10.include[i].prototype);
}
}
}
},extend:function(_11,_12){
for(var _13 in _12){
_11[_13]=_12[_13];
}
return _11;
},$super:function(_14,_15,_16,_17){
return _14[_16].apply(_15,_17);
}};
nocturne.enumerable={Break:{},each:function(_18,_19,_1a){
try{
if(Array.prototype.forEach&&_18.forEach===Array.prototype.forEach){
_18.forEach(_19,_1a);
}else{
if(nocturne.isNumber(_18.length)){
for(var i=0,l=_18.length;i<l;i++){
_19.call(_18,_18[i],i,_18);
}
}else{
for(var key in _18){
if(hasOwnProperty.call(_18,key)){
_19.call(_18,_18[key],key,_18);
}
}
}
}
}
catch(e){
if(e!=nocturne.enumerable.Break){
throw e;
}
}
return _18;
},map:function(_1b,_1c,_1d){
if(Array.prototype.map&&_1b.map===Array.prototype.map){
return _1b.map(_1c,_1d);
}
var _1e=[];
nocturne.enumerable.each(_1b,function(_1f,_20,_21){
_1e.push(_1c.call(_1d,_1f,_20,_21));
});
return _1e;
},filter:function(_22,_23,_24){
if(Array.prototype.filter&&_22.filter===Array.prototype.filter){
return _22.filter(_23,_24);
}
var _25=[],_26=!nocturne.isArray(_22);
nocturne.enumerable.each(_22,function(_27,_28,_29){
if(_23.call(_24,_27,_28,_29)){
if(_26){
_25.push([_28,_27]);
}else{
_25.push(_27);
}
}
});
return _25;
},reject:function(_2a,_2b,_2c){
return this.filter(_2a,function(){
return !_2b.apply(_2c,arguments);
},_2c);
},reduce:function(_2d,_2e,_2f,_30){
if(Array.prototype.reduce&&_2d.reduce===Array.prototype.reduce){
return _2d.reduce(nocturne.bind(_2f,_30),_2e);
}
nocturne.enumerable.each(_2d,function(_31,_32,_33){
_2e=_2f.call(_30,_2e,_31,_32,_33);
});
return _2e;
},flatten:function(_34){
return nocturne.enumerable.reduce(_34,[],function(_35,_36){
if(nocturne.isArray(_36)){
return _35.concat(nocturne.enumerable.flatten(_36));
}
_35.push(_36);
return _35;
});
},tail:function(_37,_38){
_38=typeof _38==="undefined"?1:_38;
return Array.prototype.slice.apply(_37,[_38]);
},invoke:function(_39,_3a){
var _3b=nocturne.enumerable.tail(arguments,2);
return nocturne.enumerable.map(_39,function(_3c){
return (_3a?_3c[_3a]:_3c).apply(_3c,_3b);
});
},pluck:function(_3d,key){
return nocturne.enumerable.map(_3d,function(_3e){
return _3e[key];
});
},some:function(_3f,_40,_41){
_40=_40||nocturne.enumerable.identity;
if(Array.prototype.some&&_3f.some===Array.prototype.some){
return _3f.some(_40,_41);
}
var _42=false;
nocturne.enumerable.each(_3f,function(_43,_44,_45){
if(_42=_40.call(_41,_43,_44,_45)){
throw nocturne.enumerable.Break;
}
});
return _42;
},detect:function(_46,_47,_48){
var _49;
nocturne.enumerable.each(_46,function(_4a,_4b,_4c){
if(_47.call(_48,_4a,_4b,_4c)){
_49=_4a;
throw nocturne.enumerable.Break;
}
});
return _49;
},chain:function(_4d){
return new nocturne.enumerable.Chainer(_4d);
},identity:function(_4e){
return _4e;
},all:function(_4f,_50,_51){
_50=_50||nocturne.enumerable.identity;
if(Array.prototype.every&&_4f.every===Array.prototype.every){
return _4f.every(_50,_51);
}
var _52=true;
nocturne.enumerable.each(_4f,function(_53,_54,_55){
if(!(_52=_52&&_50.call(_51,_53,_54,_55))){
throw nocturne.enumerable.Break;
}
});
return _52;
},include:function(_56,_57){
if(Array.prototype.indexOf&&_56.indexOf===Array.prototype.indexOf){
return _56.indexOf(_57)!=-1;
}
var _58=false;
nocturne.enumerable.each(_56,function(_59,key){
if(_58=_59===_57){
throw nocturne.enumerable.Break;
}
});
return _58;
},};
nocturne.enumerable.select=nocturne.enumerable.filter;
nocturne.enumerable.inject=nocturne.enumerable.reduce;
nocturne.enumerable.collect=nocturne.enumerable.map;
nocturne.enumerable.rest=nocturne.enumerable.tail;
nocturne.enumerable.any=nocturne.enumerable.some;
nocturne.enumerable.every=nocturne.enumerable.all;
nocturne.chainableMethods=["map","collect","detect","filter","reduce","tail","rest","reject","pluck","any","some"];
nocturne.enumerable.Chainer=function(_5a){
this.results=_5a;
};
nocturne.enumerable.Chainer.prototype.values=function(){
return this.results;
};
nocturne.enumerable.each(nocturne.chainableMethods,function(_5b){
var _5c=nocturne.enumerable[_5b];
nocturne.enumerable.Chainer.prototype[_5b]=function(){
var _5d=Array.prototype.slice.call(arguments);
_5d.unshift(this.results);
this.results=_5c.apply(this,_5d);
return this;
};
});
nocturne.functional={curry:nocturne.bind,memorize:function(_5e,fn){
var _5f=function(n){
var _60=_5e[n];
if(typeof _60!=="number"){
_60=fn(_5f,n);
_5e[n]=_60;
}
return _60;
};
return _5f;
}};
(function(){
var dom={},_61=Error,_62,_63,_64,_65,_66,_67,_68,_69;
_62={"nl":"\n|\r\n|\r|\f","w":"[s\r\n\f]*","nonascii":"[^\x00-]","num":"-?([0-9]+|[0-9]*.[0-9]+)","unicode":"\\[0-9A-Fa-f]{1,6}(\r\n|[s\n\r\t\f])?","escape":"#{unicode}|\\[^\n\r\f0-9A-Fa-f]","nmchar":"[_A-Za-z0-9-]|#{nonascii}|#{escape}","nmstart":"[_A-Za-z]|#{nonascii}|#{escape}","ident":"[-@]?(#{nmstart})(#{nmchar})*","name":"(#{nmchar})+","string1":"\"([^\n\r\f\"]|#{nl}|#{nonascii}|#{escape})*\"","string2":"'([^\n\r\f']|#{nl}|#{nonascii}|#{escape})*'","string":"#{string1}|#{string2}"};
_63={"name and id":"(#{ident}##{ident})","id":"(##{ident})","class":"(\\.#{ident})","name and class":"(#{ident}\\.#{ident})","element":"(#{ident})","pseudo class":"(:#{ident})"};
function _6a(){
function _6b(_6c,_6d){
var _6e=true,_6f;
while(_6e){
_6f=_6c.match(/#\{([^}]+)\}/);
if(_6f&&_6f[1]){
_6c=_6c.replace(new RegExp("#{"+_6f[1]+"}","g"),_6d[_6f[1]]);
_6e=true;
}else{
_6e=false;
}
}
return _6c;
};
function _70(_71){
return _71.replace(/\//g,"//");
};
function _72(){
var key,_73,_74={},_75,_76;
if(arguments.length===2){
_76=arguments[0];
_75=arguments[1];
}else{
_76=arguments[0];
_75=arguments[0];
}
for(key in _75){
_73=_70(_6b(_75[key],_76));
_74[key]=_73;
}
return _74;
};
function _77(_78){
var _79=[],key;
for(key in _78){
_79.push(_78[key]);
}
return new RegExp(_79.join("|"),"g");
};
return _77(_72(_72(_62),_63));
};
_69=_6a();
_65={byId:function(_7a,id){
if(_7a===null){
return [];
}
return [_7a.getElementById(id)];
},byNodeName:function(_7b,_7c){
if(_7b===null){
return [];
}
var i,_7d=[],_7e=_7b.getElementsByTagName(_7c);
for(i=0;i<_7e.length;i++){
_7d.push(_7e[i]);
}
return _7d;
},byClassName:function(_7f,_80){
if(_7f===null){
return [];
}
var i,_81=[],_82=_7f.getElementsByTagName("*");
for(i=0;i<_82.length;i++){
if(_82[i].className.match("\\b"+_80+"\\b")){
_81.push(_82[i]);
}
}
return _81;
}};
_67={"id":function(_83,_84){
_84=_84.split("#")[1];
return _65.byId(_83,_84);
},"name and id":function(_85,_86){
var _87=_86.split("#"),_88,id;
_88=_87[0];
id=_87[1];
return _68.byAttr(_65.byId(_85,id),"nodeName",_88.toUpperCase());
},"name":function(_89,_8a){
return _65.byNodeName(_89,_8a);
},"class":function(_8b,_8c){
_8c=_8c.split(".")[1];
return _65.byClassName(_8b,_8c);
},"name and class":function(_8d,_8e){
var _8f=_8e.split("."),_90,_91;
_90=_8f[0];
_91=_8f[1];
return _68.byAttr(_65.byClassName(_8d,_91),"nodeName",_90.toUpperCase());
}};
if(typeof document.getElementsByClassName!=="undefined"){
_65.byClassName=function(_92,_93){
return _92.getElementsByClassName(_93);
};
}
_68={byAttr:function(_94,_95,_96){
var key,_97=[];
for(key in _94){
if(_94[key]&&_94[key][_95]===_96){
_97.push(_94[key]);
}
}
return _97;
}};
_66={"id":function(_98,_99){
_99=_99.split("#")[1];
return _98&&_98.id===_99;
},"name":function(_9a,_9b){
return _9a.nodeName===_9b.toUpperCase();
},"name and id":function(_9c,_9d){
return _66.id(_9c,_9d)&&_66.name(_9c,_9d.split("#")[0]);
},"class":function(_9e,_9f){
if(_9e&&_9e.className){
_9f=_9f.split(".")[1];
return _9e.className.match("\\b"+_9f+"\\b");
}
},"name and class":function(_a0,_a1){
return _66["class"](_a0,_a1)&&_66.name(_a0,_a1.split(".")[0]);
}};
function _a2(_a3,_a4){
this.root=_a3;
this.key_selector=_a4.pop();
this.tokens=_a4;
this.results=[];
};
_a2.prototype.matchesToken=function(_a5,_a6){
if(!_66[_a6.finder]){
throw new _61("Invalid matcher: "+_a6.finder);
}
return _66[_a6.finder](_a5,_a6.identity);
};
_a2.prototype.find=function(_a7){
if(!_67[_a7.finder]){
throw new _61("Invalid finder: "+_a7.finder);
}
return _67[_a7.finder](this.root,_a7.identity);
};
_a2.prototype.matchesAllRules=function(_a8){
var _a9=this.tokens.slice(),_aa=_a9.pop(),_ab=false;
if(!_aa||!_a8){
return false;
}
while(_a8&&_aa){
if(this.matchesToken(_a8,_aa)){
_ab=true;
_aa=_a9.pop();
}
_a8=_a8.parentNode;
}
return _ab&&_a9.length===0;
};
_a2.prototype.parse=function(){
var i,_ac,_ad=this.find(this.key_selector),_ae=[];
for(i=0;i<_ad.length;i++){
_ac=_ad[i];
if(this.tokens.length>0){
if(this.matchesAllRules(_ac.parentNode)){
_ae.push(_ac);
}
}else{
if(this.matchesToken(_ac,this.key_selector)){
_ae.push(_ac);
}
}
}
return _ae;
};
_a2.prototype.values=function(){
return this.results;
};
function _af(_b0){
return _b0.replace(/^\s+|\s+$/g,"").replace(/[ \t\r\n\f]+/g," ");
};
function _b1(_b2,_b3){
this.identity=_b2;
this.finder=_b3;
};
_b1.prototype.toString=function(){
return "identity: "+this.identity+", finder: "+this.finder;
};
function _b4(_b5){
this.selector=_af(_b5);
this.tokens=[];
this.tokenize();
};
_b4.prototype.tokenize=function(){
var _b6,r,_b7;
r=_69;
r.lastIndex=0;
while(_b6=r.exec(this.selector)){
_b7=null;
if(_b6[10]){
_b7="id";
}else{
if(_b6[1]){
_b7="name and id";
}else{
if(_b6[29]){
_b7="name";
}else{
if(_b6[15]){
_b7="class";
}else{
if(_b6[20]){
_b7="name and class";
}
}
}
}
}
this.tokens.push(new _b1(_b6[0],_b7));
}
return this.tokens;
};
_b4.prototype.finders=function(){
var i,_b8=[];
for(i in this.tokens){
_b8.push(this.tokens[i].finder);
}
return _b8;
};
dom.tokenize=function(_b9){
var _ba=new _b4(_b9);
return _ba;
};
dom.get=function(_bb){
var _bc=dom.tokenize(_bb).tokens,_bd=typeof arguments[1]==="undefined"?document:arguments[1],_be=new _a2(_bd,_bc);
return _be.parse();
};
dom.findElement=function(_bf,_c0,_c1){
var _c2=dom.tokenize(_c0).tokens,_c3=new _a2(_c1,[]);
_c3.tokens=_c2;
while(_bf){
if(_c3.matchesAllRules(_bf)){
return _bf;
}
_bf=_bf.parentNode;
}
};
nocturne.init=function(_c4){
return new nocturne.domChain.init(_c4);
};
nocturne.domChain={init:function(_c5){
this.selector=_c5;
this.length=0;
this.prevObject=null;
this.elements=[];
if(!_c5){
return this;
}else{
return this.find(_c5);
}
},writeElements:function(){
for(var i=0;i<this.elements.length;i++){
this[i]=this.elements[i];
}
},first:function(){
return this.elements.length===0?null:this.elements[0];
},find:function(_c6){
var _c7=[],ret=nocturne(),_c8=document;
if(this.prevObject){
if(this.prevObject.elements.length>0){
_c8=this.prevObject.elements[0];
}else{
_c8=null;
}
}
_c7=dom.get(_c6,_c8);
this.elements=_c7;
ret.elements=_c7;
ret.selector=_c6;
ret.length=_c7.length;
ret.prevObject=this;
ret.writeElements();
return ret;
}};
nocturne.domChain.init.prototype=nocturne.domChain;
nocturne.dom=dom;
})();
(function(){
var _c9={},_ca=[],_cb=false,_cc=false,_cd,_ce=[];
function _cf(_d0){
return _d0.nodeType!==3&&_d0.nodeType!==8;
};
function _d1(_d2){
_d2.preventDefault(_d2);
_d2.stopPropagation(_d2);
};
function fix(_d3,_d4){
if(!_d3){
var _d3=window.event;
}
_d3.stop=function(){
_d1(_d3);
};
if(typeof _d3.target==="undefined"){
_d3.target=_d3.srcElement||_d4;
}
if(!_d3.preventDefault){
_d3.preventDefault=function(){
_d3.returnValue=false;
};
}
if(!_d3.stopPropagation){
_d3.stopPropagation=function(){
_d3.cancelBubble=true;
};
}
if(_d3.target&&_d3.target.nodeType===3){
_d3.target=_d3.target.parentNode;
}
if(_d3.pageX==null&&_d3.clientX!=null){
var doc=document.documentElement,_d5=document.body;
_d3.pageX=_d3.clientX+(doc&&doc.scrollLeft||_d5&&_d5.scrollLeft||0)-(doc&&doc.clientLeft||_d5&&_d5.clientLeft||0);
_d3.pageY=_d3.clientY+(doc&&doc.scrollTop||_d5&&_d5.scrollTop||0)-(doc&&doc.clientTop||_d5&&_d5.clientTop||0);
}
return _d3;
};
function _d6(_d7,_d8){
return function(_d9){
fix(_d9,_d7);
return _d8(_d9);
};
};
function _da(_db,_dc,_dd){
var i=0,_de,j=0;
for(j=0;j<_ca.length;j++){
if(_ca[j].element!==_db&&_ca[j].type!==_dc&&_ca[j].handler!==_dd){
_ca[i++]=_ca[j];
}else{
_de=_ca[j].responder;
}
}
_ca.length=i;
return _de;
};
function _df(){
if(!_cc){
if(!document.body){
return setTimeout(_df,13);
}
_cc=true;
for(var i in _ce){
_ce[i]();
}
_ce=null;
}
};
function _e0(){
if(_cc){
return;
}
try{
document.documentElement.doScroll("left");
}
catch(e){
setTimeout(_e0,1);
return;
}
_df();
};
if(document.addEventListener){
_cd=function(){
document.removeEventListener("DOMContentLoaded",_cd,false);
_df();
};
}else{
if(document.attachEvent){
_cd=function(){
if(document.readyState==="complete"){
document.detachEvent("onreadystatechange",_cd);
_df();
}
};
}
}
function _e1(){
if(_cb){
return;
}
_cb=true;
if(document.readyState==="complete"){
_df();
}else{
if(document.addEventListener){
document.addEventListener("DOMContentLoaded",_cd,false);
window.addEventListener("load",_df,false);
}else{
if(document.attachEvent){
document.attachEvent("onreadystatechange",_cd);
window.attachEvent("onload",_df);
var _e2=false;
try{
_e2=window.frameElement==null;
}
catch(e){
}
if(document.documentElement.doScroll&&_e2){
_e0();
}
}
}
}
};
function _e3(_e4){
if(_e4.match(/:/)){
return _e4;
}
return "on"+_e4;
};
_c9.add=function(_e5,_e6,_e7){
if(!_cf(_e5)){
return;
}
var _e8=_d6(_e5,_e7);
_ca.push({element:_e5,type:_e6,handler:_e7,responder:_e8});
if(_e6.match(/:/)&&_e5.attachEvent){
_e5.attachEvent("ondataavailable",_e8);
}else{
if(_e5.addEventListener){
_e5.addEventListener(_e6,_e8,false);
}else{
if(_e5.attachEvent){
_e5.attachEvent(_e3(_e6),_e8);
}
}
}
};
_c9.remove=function(_e9,_ea,_eb){
if(!_cf(_e9)){
return;
}
var _ec=_da(_e9,_ea,_eb);
if(document.removeEventListener){
_e9.removeEventListener(_ea,_ec,false);
}else{
_e9.detachEvent(_e3(_ea),_ec);
}
};
_c9.fire=function(_ed,_ee){
var _ef;
if(document.createEventObject){
_ef=document.createEventObject();
fix(_ef,_ed);
if(_ee.match(/:/)){
_ef.eventName=_ee;
_ef.eventType="ondataavailable";
return _ed.fireEvent(_ef.eventType,_ef);
}else{
return _ed.fireEvent(_e3(_ee),_ef);
}
}else{
_ef=document.createEvent("HTMLEvents");
fix(_ef,_ed);
_ef.eventName=_ee;
_ef.initEvent(_ee,true,true);
return !_ed.dispatchEvent(_ef);
}
};
_c9.ready=function(_f0){
_e1();
_ce.push(_f0);
};
if(nocturne.dom!=="undefined"){
_c9.delegate=function(_f1,_f2,_f3,_f4){
return _c9.add(_f1,_f3,function(_f5){
var _f6=nocturne.dom.findElement(_f5.target,_f2,_f5.currentTarget);
if(_f6){
_f4(_f5);
}
});
};
}
_c9.addDOMMethods=function(){
if(typeof nocturne.domChain==="undefined"){
return;
}
nocturne.domChain.bind=function(_f7,_f8){
var _f9=this.first();
if(_f9){
nocturne.events.add(_f9,_f7,_f8);
return this;
}
};
};
_c9.addDOMMethods();
nocturne.events=_c9;
if(typeof window!=="undefined"&&window.attachEvent&&!window.addEventListener){
window.attachEvent("onunload",function(){
for(var i=0;i<_ca.length;i++){
try{
_c9.remove(_ca[i].element,_ca[i].type);
_ca[i]=null;
}
catch(e){
}
}
});
}
})();
(function(){
var _fa={},_fb={};
_fa.swipeThreshold=50;
_fa.orientation=function(){
var _fc=window.orientation,_fd="";
switch(_fc){
case 0:
_fd+="portrait";
break;
case -90:
_fd+="landscape rigth";
break;
case 90:
_fd+="landscape left";
break;
case 180:
_fd+="portrait upside-down";
break;
}
return [_fc,_fd];
};
function _fe(e){
_fb.touches=e.touches;
_fb.startTime=(new Date).getTime();
_fb.x=e.changedTouches[0].clientX;
_fb.y=e.changedTouches[0].clientY;
_fb.startX=_fb.x;
_fb.startY=_fb.y;
_fb.target=e.target;
_fb.duration=0;
};
function _ff(e){
var x=e.changedTouches[0].clientX,y=e.changedTouches[0].clientY;
if(_fb.x===x&&_fb.y===y&&_fb.touches.length==1){
nocturne.events.fire(e.target,"tap");
}
};
function _100(e){
var _101=0,_fa=e.changedTouches[0];
_fb.duration=(new Date).getTime()-_fb.startTime;
_fb.x=_fb.startX-_fa.pageX;
_fb.y=_fb.startY-_fa.pageY;
_101=Math.sqrt(Math.pow(Math.abs(_fb.x),2)+Math.pow(Math.abs(_fb.y),2));
if(_fb.duration<1000&&_101>nocturne.touch.swipeThreshold){
nocturne.events.fire(e.target,"swipe");
}
};
_fa.register=function(){
nocturne.events.add(document,"touchstart",_fe);
nocturne.events.add(document,"touchmove",_100);
nocturne.events.add(document,"touchend",_ff);
nocturne.touch.swipeThreshold=screen.width/5;
};
nocturne.touch=_fa;
})();
(function(){
nocturne.aliasFramework=function(){
var _102=function(){
return nocturne(arguments[0]);
};
if(nocturne.enumerable){
nocturne.enumerable.each(nocturne.enumerable,function(fn,_103){
_102[_103]=fn;
});
}
if(nocturne.dom){
_102.dom=nocturne.dom;
}
if(nocturne.events){
_102.events=nocturne.events;
}
return _102;
};
nocturne.exportAlias(nocturne.alias,nocturne.aliasFramework);
})();
(function(){
var anim={},_104={},_105,_106,_107={};
function _108(_109){
return _109.replace(/-+(.)?/g,function(_10a,chr){
return chr?chr.toUpperCase():"";
});
};
function _10b(){
return (typeof document.body.style.opacity!=="undefined")?"opacity":"filter";
};
function _10c(_10d){
this.r=0;
this.g=0;
this.b=0;
this.value=this.normalise(_10d);
this.parse();
};
_10c.matchers=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(bits){
return [parseInt(bits[1]),parseInt(bits[2]),parseInt(bits[3])];
}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(bits){
return [parseInt(bits[1],16),parseInt(bits[2],16),parseInt(bits[3],16)];
}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(bits){
return [parseInt(bits[1]+bits[1],16),parseInt(bits[2]+bits[2],16),parseInt(bits[3]+bits[3],16)];
}}];
_10c.prototype.normalise=function(_10e){
_10e.replace(/ /g,"");
if(_10e.charAt(0)=="#"){
_10e=_10e.substr(1,6);
}
return _10e;
};
_10c.prototype.parse=function(){
var _10f=[],i;
for(i=0;i<_10c.matchers.length;i++){
_10f=this.value.match(_10c.matchers[i].re);
if(_10f){
_10f=_10c.matchers[i].process(_10f);
this.r=_10f[0];
this.g=_10f[1];
this.b=_10f[2];
break;
}
}
this.validate();
};
_10c.prototype.validate=function(){
this.r=(this.r<0||isNaN(this.r))?0:((this.r>255)?255:this.r);
this.g=(this.g<0||isNaN(this.g))?0:((this.g>255)?255:this.g);
this.b=(this.b<0||isNaN(this.b))?0:((this.b>255)?255:this.b);
};
_10c.prototype.sum=function(){
return this.r+this.g+this.b;
};
_10c.prototype.toString=function(){
return "rgb("+this.r+", "+this.g+", "+this.b+")";
};
function _110(_111){
return typeof _111==="string"&&_111.match(/(#[a-f|A-F|0-9]|rgb)/);
};
function _112(_113){
return {value:new _10c(_113),units:"",transform:_114};
};
function _115(_116,_117,_118){
return (_118(_117)*_116.value);
};
function _114(v,_119,_11a){
var _11b=[];
_11b[0]=Math.round(v.base.r+(v.direction[0]*(Math.abs(v.base.r-v.value.r)*_11a(_119))));
_11b[1]=Math.round(v.base.g+(v.direction[1]*(Math.abs(v.base.g-v.value.g)*_11a(_119))));
_11b[2]=Math.round(v.base.b+(v.direction[2]*(Math.abs(v.base.b-v.value.b)*_11a(_119))));
return "rgb("+_11b.join(", ")+")";
};
function _11c(_11d){
var n=(typeof _11d==="string")?parseFloat(_11d):_11d,_11e=(typeof _11d==="string")?_11d.replace(n,""):"";
return {value:n,units:_11e,transform:_115};
};
function _11f(_120,_121,_122){
if(_110(_120)){
var _123=_112(_120),i;
_123.base=new _10c(_121.style[_122]);
_123.direction=[_123.base.r<_123.value.r?1:-1,_123.base.g<_123.value.g?1:-1,_123.base.b<_123.value.b?1:-1];
return _123;
}else{
return _11c(_120);
}
};
function _124(_125,_126,_127){
if(_126=="opacity"&&_106=="filter"){
_125.style[_106]="alpha(opacity="+Math.round(_127*100)+")";
return _125;
}
_125.style[_126]=_127;
return _125;
};
_104.linear=function(_128){
return _128;
};
_104.sine=function(_129){
return (-Math.cos(_129*Math.PI)/2)+0.5;
};
_104.reverse=function(_12a){
return 1-_12a;
};
_104.spring=function(_12b){
return 1-(Math.cos(_12b*Math.PI*4)*Math.exp(-_12b*6));
};
_104.bounce=function(_12c){
if(_12c<(1/2.75)){
return 7.6*_12c*_12c;
}else{
if(_12c<(2/2.75)){
return 7.6*(_12c-=(1.5/2.75))*_12c+0.74;
}else{
if(_12c<(2.5/2.75)){
return 7.6*(_12c-=(2.25/2.75))*_12c+0.91;
}else{
return 7.6*(_12c-=(2.625/2.75))*_12c+0.98;
}
}
}
};
anim.animate=function(_12d,_12e,_12f,_130){
var _12e=_12e,_131=(new Date).valueOf(),_132=_131+_12e,_133=_104.linear,_134;
if(!_106){
_106=_10b();
}
_130=_130||{};
if(_130.hasOwnProperty("easing")){
if(typeof _130.easing==="string"){
_133=_104[_130.easing];
}else{
if(_130.easing){
_133=_130.easing;
}
}
}
for(var _135 in _12f){
if(_12f.hasOwnProperty(_135)){
_12f[_135]=_11f(_12f[_135],_12d,_135);
if(_135=="opacity"&&_106=="filter"){
_12d.style.zoom=1;
}else{
if(_107.vendorPrefix&&_135=="left"||_135=="top"){
_107.start(_12d,_12e,_135,_12f[_135].value+_12f[_135].units,_130.easing);
setTimeout(function(){
_107.end(_12d,_135);
},_12e);
return;
}
}
}
}
_134=setInterval(function(){
var time=(new Date).valueOf(),_136=time>_132?1:(time-_131)/_12e;
for(var _137 in _12f){
if(_12f.hasOwnProperty(_137)){
_124(_12d,_137,_12f[_137].transform(_12f[_137],_136,_133)+_12f[_137].units);
}
}
if(time>_132){
clearInterval(_134);
}
},10);
};
_107={vendors:{"opera":{"prefix":"-o-","detector":function(){
try{
document.createEvent("OTransitionEvent");
return true;
}
catch(e){
return false;
}
}},"webkit":{"prefix":"-webkit-","detector":function(){
try{
document.createEvent("WebKitTransitionEvent");
return true;
}
catch(e){
return false;
}
}},"firefox":{"prefix":"-moz-","detector":function(){
var div=document.createElement("div"),_138=false;
if(typeof div.style.MozTransition!=="undefined"){
_138=true;
}
div=null;
return _138;
}}},findCSS3VendorPrefix:function(){
for(var _139 in _107.vendors){
_139=this.vendors[_139];
if(_139["detector"]()){
return _139["prefix"];
}
}
},vendorPrefix:null,start:function(_13a,_13b,_13c,_13d,_13e){
_13a.style[_108(this.vendorPrefix+"transition")]=_13c+" "+_13b+"ms "+(_13e||"linear");
_13a.style[_13c]=_13d;
},end:function(_13f,_140){
_13f.style[_108(this.vendorPrefix+"transition")]=null;
}};
_107.vendorPrefix=_107.findCSS3VendorPrefix();
anim.fade=function(_141,_142,_143,_144){
_141.style.opacity=_143.from;
return anim.animate(_141,_142,{"opacity":_143.to},{"easing":_143.easing});
};
anim.fadeIn=function(_145,_146,_147){
_147=_147||{};
_147.from=_147.from||0;
_147.to=_147.to||1;
return anim.fade(_145,_146,_147);
};
anim.fadeOut=function(_148,_149,_14a){
var from;
_14a=_14a||{};
_14a.from=_14a.from||1;
_14a.to=_14a.to||0;
from=_14a.from;
_14a.from=_14a.to;
_14a.to=from;
_14a.easing=function(p){
return (1-p)+_14a.from;
};
return anim.fade(_148,_149,_14a,{"easing":_14a.easing});
};
anim.highlight=function(_14b,_14c,_14d){
var _14e=_14b.currentStyle?_14b.currentStyle:getComputedStyle(_14b,null);
_14d=_14d||{};
_14d.from=_14d.from||"#ff9";
_14d.to=_14d.to||_14e.backgroundColor;
_14d.easing=_14d.easing||_104.sine;
_14c=_14c||500;
_14b.style.backgroundColor=_14d.from;
return setTimeout(function(){
anim.animate(_14b,_14c,{"backgroundColor":_14d.to,"easing":_14d.easing});
},200);
};
anim.move=function(_14f,_150,_151){
return anim.animate(_14f,_150,{"left":_151.x,"top":_151.y},{"easing":_151.easing||_104.sine});
};
anim.parseColor=function(_152){
return new _10c(_152);
};
anim.pause=function(_153,_154,_155){
};
anim.easing=_104;
_105=function(_156){
this.element=_156;
this.position=0;
};
for(methodName in anim){
(function(_157){
var _157=anim[methodName];
_105.prototype[methodName]=function(){
var args=Array.prototype.slice.call(arguments);
args.unshift(this.element);
this.position+=args[1]||0;
setTimeout(function(){
_157.apply(null,args);
},this.position);
return this;
};
})(methodName);
}
anim.chain=function(_158){
return new _105(_158);
};
nocturne.anim=anim;
})();

